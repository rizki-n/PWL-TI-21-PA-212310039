import { useState, useMemo } from 'react';
import React from 'react'; 
import TodoSearch from './TodoSearch';
import '../index.css'

const TodoWrapper = () => {
    const [todo, setTodo] = useState([]);
    const [filter, setFilter] = useState('all'); // State untuk filter aktif

    const filteredTodos = useMemo(() => {
        switch (filter) {
            case 'done':
                return todo.filter(t => t.completed);
            case 'todo':
                return todo.filter(t => !t.completed);
            default:
                return todo;
        }
    }, [todo, filter]);

    const handleFilterChange = (newFilter) => {
        setFilter(newFilter);
    };

    const checklist = id => {
        setTodo(todo.map(item => item.id === id ? { ...item, completed: !item.completed } : item ));
    }

    const deleteTask = id => {
        setTodo(todo.filter(t => t.id !== id));
    }

    const deleteAllTasks = () => {
        setTodo([]);
    }

    const deleteDoneTasks = () => {
        setTodo(todo.filter(t => !t.completed));
    }

    const editTask = id => {
        setTodo(todo.map(t => t.id === id ? { ...t, isEditing: !t.isEditing } : t ));
    }

    return (
        <div>
            <div>
                <h1>To Do Search</h1>
                <TodoSearch todo={todo} setTodo={setTodo}/>

                <h1>To Do List</h1>
                <div>
                    <button onClick={() => handleFilterChange('all')}>All</button>
                    <button onClick={() => handleFilterChange('done')}>Done</button>
                    <button onClick={() => handleFilterChange('todo')}>To Do</button>
                </div>

                <ol>
                    {filteredTodos.map(todos => (
                        <li className='' key={todos.id}>
                            <input type='text' 
                            value={todos.name}
                            className={`text ${todos.completed ? 'completed' : ''}`}
                            onChange={(e) => e.preventDefault()} 
                            />
                            <button onClick={() => checklist(todos.id)}>‚úî</button>
                            <button onClick={() => deleteTask(todos.id)}>üóë</button>
                            <button onClick={() => editTask(todos.id)}>‚úè</button>
                        </li>   
                    ))}
                </ol>
                <div>
                    <button onClick={deleteAllTasks}>Delete All Tasks</button>
                    <button onClick={deleteDoneTasks}>Delete Done Tasks</button>
                </div>
            </div>
        </div>
    );
}

export default TodoWrapper;
